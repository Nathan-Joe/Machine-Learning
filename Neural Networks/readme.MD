Code does not work for SGD but for part a and bonus question, it works perfectly fine. 
